(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{106:function(e,t,n){},285:function(e){e.exports=JSON.parse('{"name":"Berkeley Mayor Election","description":"Berkeley, home to America\'s top college, goes to the polls to elect its next mayor. The field of candidates is small but formidable.","numcands":4,"candidates":["Oski","Carol Christ","Chairman Bob","Alice Waters"],"ballots":[{"votes":4567,"order":["Oski","Carol Christ","Alice Waters","Chairman Bob"]},{"votes":2599,"order":["Carol Christ","Alice Waters","Chairman Bob","Oski"]},{"votes":1345,"order":["Alice Waters","Chairman Bob","Carol Christ","Oski"]},{"votes":1587,"order":["Chairman Bob","Alice Waters","Carol Christ","Oski"]},{"votes":267,"order":["Oski","Alice Waters","Carol Christ","Chairman Bob"]},{"votes":250,"order":["Chairman Bob","Oski","Carol Christ","Alice Waters"]},{"votes":150,"order":["Oski","Chairman Bob","Alice Waters","Carol Christ"]},{"votes":197,"order":["Alice Waters","Oski","Carol Christ","Chairman Bob"]},{"votes":102,"order":["Carol Christ","Oski","Alice Waters","Chairman Bob"]},{"votes":98,"order":["Alice Waters","Carol Christ","Oski","Chairman Bob"]}]}')},286:function(e){e.exports=JSON.parse('{"name":"Galactic Chancellor Election","description":"In the midst of the Naboo crisis, the galactic senate passed a vote of no confiderence in Chancellor Valorum\'s leadership. Now, the senate must elect a new leader for the Galaxy.","numcands":6,"candidates":["Palpatine","Yoda","Jar Jar Binks","R2D2","C3PO","Qui Gon Jinn"],"ballots":[{"votes":28765,"order":["Palpatine","R2D2","Yoda","C3PO","Qui Gon Jinn","Jar Jar Binks"]},{"votes":17845,"order":["R2D2","Yoda","C3PO","Palpatine","Qui Gon Jinn","Jar Jar Binks"]},{"votes":16534,"order":["Qui Gon Jinn","R2D2","Palpatine","Yoda","C3PO","Jar Jar Binks"]},{"votes":15456,"order":["C3PO","Qui Gon Jinn","Yoda","R2D2","Palpatine","Jar Jar Binks"]},{"votes":12765,"order":["Yoda","Palpatine","R2D2","C3PO","Qui Gon Jinn","Jar Jar Binks"]},{"votes":11180,"order":["Palpatine","Yoda","Qui Gon Jinn","R2D2","C3PO","Jar Jar Binks"]},{"votes":9964,"order":["Qui Gon Jinn","R2D2","C3PO","Palpatine","Yoda","Jar Jar Binks"]},{"votes":8745,"order":["R2D2","C3PO","Qui Gon Jinn","Yoda","Palpatine","Jar Jar Binks"]},{"votes":6969,"order":["Qui Gon Jinn","Yoda","R2D2","Palpatine","C3PO","Jar Jar Binks"]},{"votes":6901,"order":["C3PO","Palpatine","Yoda","Qui Gon Jinn","R2D2","Jar Jar Binks"]},{"votes":5467,"order":["Palpatine","R2D2","Yoda","Qui Gon Jinn","C3PO","Jar Jar Binks"]},{"votes":5234,"order":["Yoda","Qui Gon Jinn","R2D2","Palpatine","C3PO","Jar Jar Binks"]},{"votes":4634,"order":["C3PO","Qui Gon Jinn","Palpatine","R2D2","Yoda","Jar Jar Binks"]},{"votes":3333,"order":["R2D2","Yoda","C3PO","Qui Gon Jinn","Palpatine","Jar Jar Binks"]},{"votes":1987,"order":["Qui Gon Jinn","C3PO","Yoda","R2D2","Palpatine","Jar Jar Binks"]},{"votes":1567,"order":["C3PO","R2D2","Palpatine","Yoda","Qui Gon Jinn","Jar Jar Binks"]}]}')},293:function(e,t,n){"use strict";n.r(t);var s=n(0),i=n.n(s),a=n(25),r=n.n(a),o=n(180),c=n(28),l=n(297),d=n(301),h=n(37),u=n(65),m=n(26),f=n(50),p=(n(106),n(4)),j=(l.a.Header,l.a.Content);l.a.Footer;var b=function(){return Object(p.jsxs)("div",{children:[Object(p.jsx)(h.a,{fixed:"top",bg:"primary",variant:"dark",children:Object(p.jsxs)(u.a,{children:[Object(p.jsx)(h.a.Brand,{href:"/instantrunoff/",children:"Social Choice"}),Object(p.jsxs)(m.a,{className:"me-auto",children:[Object(p.jsx)(m.a.Link,{href:"/instantrunoff/",children:"About"}),Object(p.jsx)(m.a.Link,{href:"/instantrunoff/simulator",children:"Run Decision Algorithms"}),Object(p.jsx)(m.a.Link,{href:"/instantrunoff/login",children:"Log In/Create Account"}),Object(p.jsx)(m.a.Link,{href:"/instantrunoff/addelection",children:"Create my Own Scenario"})]})]})}),Object(p.jsx)(l.a,{className:"layout",children:Object(p.jsxs)(j,{style:{padding:"0 50px"},children:[Object(p.jsx)(d.a,{style:{margin:"58px 0"}}),Object(p.jsx)("div",{className:"site-layout-content",children:Object(p.jsxs)("span",{children:[Object(p.jsx)("div",{className:"sitetit",children:"Social Choice"}),Object(p.jsx)("div",{className:"sectiontit",children:"What is Social Choice?"}),Object(p.jsx)("div",{className:"aboutbody",children:"Social Choice aggregates people's preferences to recommend a collective decision. People need to make social choices in elections, when deciding on a restaurant to eat at with a group of friends, and in lots of other situations. Typically, in a social choice, there are a fixed number of alternatives to choose from. For instance, when choosing between restaurants, a group might decide between thai food, burritos, pizza and burgers. Each person in the group ranks the options in some fixed order. For instance, I might choose thai food as my most prefered option, burgers as my second most prefered, burritos as my third and pizza as my least most prefered. Then, to arrive at a decision, we apply some preference aggregation rule (or decision rule) to the set of individual preferences to arrive at some collective choice. For instance, the plurality rule chooses the option that is the modal first preference. This tool allows users to input their set of preferences and apply some decision rule to it. Then, the simulator walks through the decision rule and reaches a final collective decision. The simulator also comes with a few pre-loaded elections that demonstrate a few of the interesting quirks of each decision rule."}),Object(p.jsx)("div",{className:"sectiontit",children:"What decision rules are supported?"}),Object(p.jsxs)("div",{className:"aboutbody",children:["While there are an infinite number of possible decision rules, the simulator currently supports four common rules:",Object(p.jsxs)("ul",{children:[Object(p.jsxs)("li",{children:[" ",Object(p.jsx)("a",{href:"https://math.libretexts.org/Bookshelves/Applied_Mathematics/Math_in_Society_(Lippman)/02%3A_Voting_Theory/2.03%3A_Plurality",target:"_blank",children:"Pluraility "})," "]}),Object(p.jsxs)("li",{children:[" ",Object(p.jsx)("a",{href:"https://www2.math.upenn.edu/~deturck/m170/wk10/lecture/vote2.html",target:"_blank",children:"Hare's Method "})," "]}),Object(p.jsxs)("li",{children:[" ",Object(p.jsx)("a",{href:"https://www2.math.upenn.edu/~deturck/m170/wk10/lecture/vote3.html",target:"_blank",children:"Borda Count "})," "]}),Object(p.jsxs)("li",{children:[" ",Object(p.jsx)("a",{href:"http://web.math.princeton.edu/math_alive/Voting/Lab1/Condorcet.html",target:"_blank",children:"Condorcet Method "})," "]})]})]}),Object(p.jsx)("div",{className:"sectiontit",children:"Is there a 'most fair' decision rule to use?"}),Object(p.jsxs)("div",{className:"aboutbody",children:["No, there's no agreed upon best rule for making a social choice. It depends on what axioms we care about and what our circumstances and considerations are.",Object(p.jsx)("a",{href:"https://plato.stanford.edu/entries/arrows-theorem/",target:"_blank",children:" Arrow's Impossibility Theorem "}),"states that there are no decision rules that ",Object(p.jsx)("a",{href:"https://plato.stanford.edu/entries/arrows-theorem/#UnrDom",target:"_blank",children:" have an unrestricted domain, "}),Object(p.jsx)("a",{href:"https://plato.stanford.edu/entries/arrows-theorem/#SocOrd",target:"_blank",children:"rank the options from best to worst with no cycles,"})," ",Object(p.jsx)("a",{href:"https://plato.stanford.edu/entries/arrows-theorem/#WeaPar",target:"_blank",children:"prefer a first option over a second if every individual prefers the first option over the second,"})," ",Object(p.jsx)("a",{href:"https://plato.stanford.edu/entries/arrows-theorem/#NonDic",target:"_blank",children:"don't require giving dictatorial power to one individual,"})," and ",Object(p.jsx)("a",{href:"https://plato.stanford.edu/entries/arrows-theorem/#IndIrrAlt",target:"_blank",children:" aren't thrown off by adding irrelevant alternative options. "}),"These all seem like fairly reasonable and intuitive requirements, so the reality that no decision rule satisfies them suggests that there is no 'perfect' decision rule."]})]})})]})}),Object(p.jsx)(f.a,{fixed:"bottom",children:Object(p.jsxs)(f.a.Body,{children:[Object(p.jsx)(f.a.Title,{children:"About"}),Object(p.jsx)(f.a.Text,{children:" Social Choice was created by Sam Taplin. The source code is avaliable at https://github.com/samtaplin/instantrunoff"})]})})]})},v=n(175),O=n(123),y=n(71),x=n(72),g=n(74),k=n(73),w=(n(161),n(162),n(103)),C=n(298),A=n(61);function S(){this.name="Plurality",this.description="In a Plurality election, the candidate with the most first place votes wins even if she doesn't get a majority.",this.link="https://math.libretexts.org/Bookshelves/Applied_Mathematics/Math_in_Society_(Lippman)/02%3A_Voting_Theory/2.03%3A_Plurality",this.election=null,this.step=0}function P(){this.name="Hare's Method",this.description="In a Hare's method election, the candidate with the fewest first place votes is eliminated. Ballots with that candidate as their first choice are reallocated to their second choice candidates. This process continues until one candidate has at least 50% of the first place vote.",this.link="https://www2.math.upenn.edu/~deturck/m170/wk10/lecture/vote3.html",this.election=null,this.step=0,this.done=!1,this.defeated=new Set}function J(){this.name="Borda Count",this.description="In a borda count election with n candidates, each candidate receives n - i points for every ith-place vote they receive. The candidate with the most points wins.",this.link="https://www2.math.upenn.edu/~deturck/m170/wk10/lecture/vote2.html",this.election=null,this.step=0,this.done=!1}function N(e,t,n){for(var s,i,a=Array(t.numcands).fill(0),r=0;r<t.ballots.length;r++){i=(s=t.ballots[r]).order[e];for(var o=0;o<t.numcands;o++)n[o]===i&&(a[o]+=s.votes)}return a}function I(){this.name="Condorcet Method",this.description="In a Condorcet election, candidates are compared head to head. If one candidate wins every head-to-head matchup, he's the Condorcet winner. The votes column counts the number of head-to-head elections won and the share column counts the share of head-to-head elections won. A winner must have a share of 100.",this.link="hhttp://web.math.princeton.edu/math_alive/Voting/Lab1/Condorcet.html",this.election=null,this.step=0,this.i=0,this.j=1,this.done=!1}function B(e,t,n){for(var s,i=0,a=0,r=0;r<e.ballots.length;r++){s=e.ballots[r];for(var o=0;o<e.numcands;o++){if(e.candidates[t]===s.order[o]){i+=s.votes;break}if(e.candidates[n]===s.order[o]){a+=s.votes;break}}}return i>a?[t,i,a]:a>i?[n,a,i]:["tie",i,a]}S.prototype.setelection=function(e){this.round={candidates:e.candidates.slice(),votes:Array(e.numcands).fill(null),shares:Array(e.numcands).fill(null),eliminated:Array(e.numcands).fill(null)},this.election=e,this.step=0},S.prototype.canforward=function(){return 0===this.step&&null!==this.election},S.prototype.forward=function(){var e=function(e,t){for(var n,s,i=Array(t.numcands).fill(0),a=0;a<t.ballots.length;a++){s=(n=t.ballots[a]).order[e];for(var r=0;r<t.numcands;r++)t.candidates[r]===s&&(i[r]+=n.votes)}return i}(0,this.election),t=this.election.candidates.slice().map((function(t,n){return{name:t,tally:e[n]}}));this.round.candidates=t.sort((function(e,t){return t.tally-e.tally})).map((function(e,t){return e.name})),this.round.votes=e.sort((function(e,t){return t-e}));for(var n=0,s=0;s<this.round.candidates.length;s++)n+=e[s];for(s=0;s<this.round.candidates.length;s++)this.round.shares[s]=this.round.votes[s]/n*100,this.round.eliminated[s]=0===s?"Winner":"Eliminated";return this.step=1,this.round},S.prototype.canbackward=function(){return 1===this.step&&null!==this.election},S.prototype.backward=function(){return this.round={candidates:this.election.candidates.slice(),votes:Array(this.election.numcands).fill(null),shares:Array(this.election.numcands).fill(null),eliminated:Array(this.election.numcands).fill(null)},this.step=0,this.round},P.prototype.setelection=function(e){this.round={candidates:e.candidates.slice(),votes:Array(e.numcands).fill(null),shares:Array(e.numcands).fill(null),eliminated:Array(e.numcands).fill(null)},this.election=e,this.step=0,this.done=!1,this.defeated=new Set},P.prototype.canforward=function(){return!1===this.done&&null!==this.election},P.prototype.forward=function(){var e=function(e,t,n){for(var s,i,a=Array(t.numcands).fill(0),r=0;r<t.ballots.length;r++){i=(s=t.ballots[r]).order[e];for(var o=0;n.has(i);)o+=1,i=s.order[e+o];for(var c=0;c<t.numcands;c++)t.candidates[c]===i&&(a[c]+=s.votes)}return a}(0,this.election,this.defeated),t=this.election.candidates.slice().map((function(t,n){return{name:t,tally:e[n]}}));this.round.candidates=t.sort((function(e,t){return t.tally-e.tally})).map((function(e,t){return e.name})),this.round.votes=e.sort((function(e,t){return t-e}));for(var n=0,s=0;s<this.round.candidates.length;s++)n+=e[s];if(this.round.votes[0]>n/2){for(s=0;s<this.round.candidates.length;s++)this.round.shares[s]=this.round.votes[s]/n*100,this.round.eliminated[s]=0===s?"Winner":"Eliminated";this.done=!0}else{for(s=0;s<this.round.candidates.length;s++)this.round.shares[s]=this.round.votes[s]/n*100,s<this.round.candidates.length-1-this.step?this.round.eliminated[s]="Active":this.round.eliminated[s]="Eliminated";this.defeated.add(this.round.candidates[this.round.candidates.length-1-this.step])}return this.step+=1,this.round},P.prototype.canbackward=function(){return 0!==this.step&&null!==this.election},P.prototype.backward=function(){return 1==this.done&&(this.done=!1),this.step-=1,this.defeated.delete(this.round.candidates[this.round.candidates.length-1-this.step]),0==this.step?this.round={candidates:this.election.candidates.slice(),votes:Array(this.election.numcands).fill(null),shares:Array(this.election.numcands).fill(null),eliminated:Array(this.election.numcands).fill(null)}:(this.step-=1,this.defeated.delete(this.round.candidates[this.round.candidates.length-1-this.step]),this.forward()),this.round},J.prototype.setelection=function(e){this.round={candidates:e.candidates.slice(),votes:Array(e.numcands).fill(null),shares:Array(e.numcands).fill(null),eliminated:Array(e.numcands).fill(null)},this.election=e,this.step=0,this.done=!1},J.prototype.canforward=function(){return!1===this.done&&null!==this.election},J.prototype.forward=function(){var e,t=this,n=this.round.candidates,s=N(this.step,this.election,n),i=s.slice();s=s.map((function(e,n){return e*(t.election.numcands-1-t.step)})),e=(e=0==this.step?this.round.candidates.slice().map((function(e,t){return{name:e,tally:s[t],currnd:i[t]}})):this.round.candidates.slice().map((function(e,n){return{name:e,tally:s[n]+t.round.votes[n],currnd:i[n]}}))).sort((function(e,t){return t.tally-e.tally})),this.round.candidates=e.map((function(e,t){return e.name})),this.round.votes=e.map((function(e,t){return e.tally})),i=e.map((function(e,t){return e.currnd}));for(var a=0,r=0;r<this.round.candidates.length;r++)a+=this.round.votes[r];for(r=0;r<this.round.candidates.length;r++)this.round.shares[r]=this.round.votes[r]/a*100,this.round.eliminated[r]=i[r]+" #"+(this.step+1)+" votes counted.";return this.step+=1,this.step==this.election.numcands-1&&(this.done=!0),this.round},J.prototype.canbackward=function(){return 0!==this.step&&null!==this.election},J.prototype.backward=function(){var e=this;if(1==this.step)this.round={candidates:this.election.candidates.slice(),votes:Array(this.election.numcands).fill(null),shares:Array(this.election.numcands).fill(null),eliminated:Array(this.election.numcands).fill(null)},this.step=0;else{this.step==this.election.numcands-1&&(this.done=!1),this.step-=1;var t=this.round.candidates,n=N(this.step,this.election,t);n=n.map((function(t,n){return t*(e.election.numcands-1-e.step)}));var s=this.round.candidates.slice().map((function(t,s){return{name:t,tally:e.round.votes[s]-n[s]}}));s=s.sort((function(e,t){return t.tally-e.tally})),this.round.candidates=s.map((function(e,t){return e.name})),this.round.votes=s.map((function(e,t){return e.tally}));for(var i=0,a=0;a<this.round.candidates.length;a++)i+=this.round.votes[a];for(a=0;a<this.round.candidates.length;a++)this.round.shares[a]=this.round.votes[a]/i*100,this.round.eliminated[a]="#"+this.step+" votes included."}return this.round},I.prototype.setelection=function(e){this.round={candidates:e.candidates.slice(),votes:Array(e.numcands).fill(0),shares:Array(e.numcands).fill(null),eliminated:Array(e.numcands).fill(null)},this.election=e,this.step=0,this.done=!1,this.i=0,this.j=1},I.prototype.canforward=function(){return!1===this.done&&null!==this.election},I.prototype.forward=function(){var e,t,n,s,i=this,a=this.election.candidates;if(this.i===this.election.numcands){var r;this.done=!0,r=(r=a.slice().map((function(e,t){return{name:e,tally:i.round.votes[t]}}))).sort((function(e,t){return t.tally-e.tally})),this.round.candidates=r.map((function(e,t){return e.name})),this.round.votes=r.map((function(e,t){return e.tally}));for(var o=this.election.numcands-1,c=0;c<this.round.candidates.length;c++)this.round.shares[c]=this.round.votes[c]/o*100,this.round.votes[c]===o?this.round.eliminated[c]="Condorcet Winner":this.round.eliminated[c]="Non-Winner";return this.round}e=(s=B(this.election,this.i,this.j))[0],t=s[1],n=s[2];var l,d,h=this.election.numcands-1;"tie"!==e?(this.round.votes[e]+=1,d=this.i==e?this.j:this.i,l=a[e]+" beats "+a[d]+" by "+t+" votes to "+n+"."):l=a[this.i]+" and "+a[this.j]+" tie with "+t+" votes each.";for(c=0;c<this.round.candidates.length;c++)this.round.shares[c]=this.round.votes[c]/h*100,this.round.eliminated[c]=l;this.step+=1;do{this.j<this.election.numcands-1?this.j+=1:(this.i+=1,this.j=0)}while(this.i>=this.j&&this.i!==this.election.numcands);return this.round},I.prototype.canbackward=function(){return 0!==this.step&&null!==this.election},I.prototype.loopback=function(){do{0===this.j?(this.i-=1,this.j=this.election.numcands-1):this.j-=1}while(this.i>=this.j)},I.prototype.swap=function(e,t){this.test=e,this.test2=t;var n=this.round.candidates[t],s=this.round.votes[t];this.round.candidates[t]=this.round.candidates[e],this.round.votes[t]=this.round.votes[e],this.round.candidates[e]=n,this.round.votes[e]=s},I.prototype.backward=function(){if(1==this.step)this.round={candidates:this.election.candidates.slice(),votes:Array(this.election.numcands).fill(0),shares:Array(this.election.numcands).fill(null),eliminated:Array(this.election.numcands).fill(null)},this.step=0,this.i=0,this.j=1;else{if(!0===this.done){this.done=!1;for(var e=this.election.candidates,t=0;t<this.election.numcands;t++)if(this.round.candidates[t]!=e[t])for(var n=t+1;n<this.election.numcands;n++)if(this.round.candidates[n]==e[t]){this.swap(t,n);break}this.step-=1}else{var s;this.step-=2,this.loopback(),"tie"!==(s=B(this.election,this.i,this.j)[0])&&(this.round.votes[s]-=1)}this.loopback(),"tie"!==(s=B(this.election,this.i,this.j)[0])&&(this.round.votes[s]-=1),this.forward()}return this.round};var L=w.a.Option,D=n(143),R=[n(285),n(286)],_=[new S,new P,new J,new I],T=function(e){Object(g.a)(n,e);var t=Object(k.a)(n);function n(){return Object(y.a)(this,n),t.apply(this,arguments)}return Object(x.a)(n,[{key:"rendercandidate",value:function(e){var t=(e+1).toString(),n=this.props.round;return{key:t,rank:t,name:n.candidates[e],votes:n.votes[e],share:n.shares[e],elim:n.eliminated[e]}}},{key:"render",value:function(){var e=this,t=this.props.round.candidates.map((function(t,n){return e.rendercandidate(n)}));return Object(p.jsx)(C.a,{dataSource:t,columns:[{title:"#",dataIndex:"rank",key:"rank"},{title:"Choice Name",dataIndex:"name",key:"name"},{title:"Votes",dataIndex:"votes",key:"votes"},{title:"Share",dataIndex:"share",key:"share"},{title:"Result",dataIndex:"elim",key:"elim"}]})}}]),n}(i.a.Component),F=function(e){Object(g.a)(n,e);var t=Object(k.a)(n);function n(){return Object(y.a)(this,n),t.apply(this,arguments)}return Object(x.a)(n,[{key:"renderballot",value:function(e,t){var n={};n.ballots=this.props.election.ballots[e].votes;for(var s=0;s<t;s++)n["#"+(s+1)]=this.props.election.ballots[e].order[s];return n}},{key:"render",value:function(){var e=this,t=this.props.election.ballots.sort((function(e,t){return t.votes-e.votes})).map((function(t,n){return e.renderballot(n,e.props.election.numcands)})),n=[];n.push({title:"# of Ballots",dataIndex:"ballots",key:"ballots",defaultSortOrder:"descend",sorter:function(e,t){return e.ballots-t.ballots}});for(var s=0;s<this.props.election.numcands;s++)n.push({title:"#"+(s+1)+" Preference",dataIndex:"#"+(s+1),key:"#"+(s+1)});return Object(p.jsx)(C.a,{dataSource:t,columns:n})}}]),n}(i.a.Component),E=function(e){Object(g.a)(n,e);var t=Object(k.a)(n);function n(e){var s;return Object(y.a)(this,n),(s=t.call(this,e)).state={history:[{candidates:Array(4).fill(null),votes:Array(4).fill(null),shares:Array(4).fill(null),eliminated:Array(4).fill(null)}],methods:_,elections:R,elnind:null,methind:null,turn:0},s.loaduserelections=s.loaduserelections.bind(Object(O.a)(s)),s}return Object(x.a)(n,[{key:"changemeth",value:function(e){if(e.value!==this.state.methind&&(this.setState({methind:e.value,turn:0}),null!=this.state.elnind)){var t=this.state.elections[this.state.elnind];this.setState({history:[{candidates:t.candidates.slice(),votes:Array(t.numcands).fill(null),shares:Array(t.numcands).fill(null),eliminated:Array(t.numcands).fill(null)}]}),this.state.methods[e.value].setelection(t)}}},{key:"changeeln",value:function(e){if(e.value!==this.state.elnind){var t=this.state.elections[e.value];this.setState({elnind:e.value,history:[{candidates:t.candidates.slice(),votes:Array(t.numcands).fill(null),shares:Array(t.numcands).fill(null),eliminated:Array(t.numcands).fill(null)}],turn:0}),null!=this.state.methind&&this.state.methods[this.state.methind].setelection(t)}}},{key:"ddmethod",value:function(){var e=this.state.methods.map((function(e,t){var n=e.name;return Object(p.jsx)(L,{value:t,children:n})}));return Object(p.jsx)(w.a,{labelInValue:!0,placeholder:"Select a Decision Rule",style:{width:240},size:"large",onChange:this.changemeth.bind(this),children:e})}},{key:"ddelection",value:function(){var e=this.state.elections.map((function(e,t){var n=e.name;return Object(p.jsx)(L,{value:t,children:n})}));return Object(p.jsx)(w.a,{labelInValue:!0,placeholder:"Select a Decision",style:{width:240},size:"large",onChange:this.changeeln.bind(this),children:e})}},{key:"handleforward",value:function(){if(null!=this.state.elnind&&null!=this.state.methind&&this.state.methods[this.state.methind].canforward()){var e=this.state.methods[this.state.methind].forward(),t=this.state.history.slice(),n=this.state.turn+1;this.setState({history:t.concat([{candidates:e.candidates,votes:e.votes,shares:e.shares,eliminated:e.eliminated}]),turn:n})}}},{key:"handlebackward",value:function(){if(null!==this.state.elnind&&null!==this.state.methind&&this.state.methods[this.state.methind].canbackward()){var e=this.state.methods[this.state.methind].backward(),t=this.state.history.slice(),n=this.state.turn+1;this.setState({history:t.concat([{candidates:e.candidates,votes:e.votes,shares:e.shares,eliminated:e.eliminated}]),turn:n})}}},{key:"loaduserelections",value:function(){var e=this,t=window.localStorage.getObject("user");if(this.setState({user:t}),console.log(t),t&&t.eids){var n,s=this.state.elections,i=Object(v.a)(t.eids);try{for(i.s();!(n=i.n()).done;){var a=n.value;D.post("/getelect",{eid:a}).then((function(n){s.push(n.data),e.setState({elections:s,user:t})})).catch((function(e){console.log(e)}))}}catch(r){i.e(r)}finally{i.f()}}}},{key:"componentDidMount",value:function(){this.loaduserelections()}},{key:"render",value:function(){var e,t,n,s,i,a=this,r=this.state.history[this.state.turn],o=this.ddmethod(),c=this.ddelection(),l=Object(p.jsx)(A.a,{onClick:function(){return a.handleforward()},block:!0,children:"Move Forward a Step"}),d=Object(p.jsx)(A.a,{onClick:function(){return a.handlebackward()},block:!0,children:"Move Backwards a Step"});if(null!==this.state.elnind)e=this.state.elections[this.state.elnind].description,n=Object(p.jsx)(F,{election:this.state.elections[this.state.elnind]});else{e="Please select a decision.";n=Object(p.jsx)(F,{election:{ballots:[],numcands:4}})}return t=null!==this.state.methind?this.state.methods[this.state.methind].description:"Please select a decision algorithm.",this.state.user?(s="Logged in as "+this.state.user.username,i=Object(p.jsx)(A.a,{className:"username",onClick:function(){window.localStorage.removeObject("user"),a.props.history.push("/")},children:"Log Out"})):(s="",i=""),Object(p.jsxs)("div",{children:[Object(p.jsx)(h.a,{fixed:"top",bg:"primary",variant:"dark",children:Object(p.jsxs)(u.a,{children:[Object(p.jsx)(h.a.Brand,{href:"/instantrunoff/",children:"Social Choice"}),Object(p.jsxs)(m.a,{className:"me-auto",children:[Object(p.jsx)(m.a.Link,{href:"/instantrunoff/",children:"About"}),Object(p.jsx)(m.a.Link,{href:"/instantrunoff/simulator",children:"Run Decision Algorithms"}),Object(p.jsx)(m.a.Link,{href:"/instantrunoff/login",children:"Log In/Create Account"}),Object(p.jsx)(m.a.Link,{href:"/instantrunoff/addelection",children:"Create my Own Scenario"}),Object(p.jsx)(h.a.Text,{children:s}),i]})]})}),Object(p.jsxs)("div",{className:"game",children:[Object(p.jsxs)("span",{children:[Object(p.jsx)("div",{className:"scenario",children:t}),Object(p.jsx)("div",{className:"scenario",children:e})]}),Object(p.jsx)("div",{className:"game-scoreboard",children:Object(p.jsxs)("span",{children:[Object(p.jsx)("div",{className:"sectiontit",children:"Results"}),Object(p.jsx)("div",{id:"forward",children:l}),Object(p.jsx)("div",{id:"forward",children:d}),Object(p.jsx)(T,{round:r}),Object(p.jsx)("div",{className:"sectiontit",children:"Preference Profile"}),n]})}),Object(p.jsx)("div",{className:"choicedd",children:Object(p.jsxs)("span",{children:[Object(p.jsx)("div",{className:"sectiontit",children:"Decision:"}),Object(p.jsx)("div",{id:"controls",children:c})]})}),Object(p.jsx)("div",{className:"choicedd",children:Object(p.jsxs)("span",{children:[Object(p.jsx)("div",{className:"sectiontit",children:"Decision Rule:"}),Object(p.jsx)("div",{children:o})]})})]}),Object(p.jsx)(f.a,{fixed:"bottom",children:Object(p.jsxs)(f.a.Body,{children:[Object(p.jsx)(f.a.Title,{children:"Outcome look wrong? "}),Object(p.jsx)(f.a.Text,{children:" This tool is a work in progress. If you're getting an incorrect result submit an issue at https://github.com/samtaplin/instantrunoff/issues. "})]})})]})}}]),n}(i.a.Component);Storage.prototype.setObject=function(e,t){this.setItem(e,JSON.stringify(t))},Storage.prototype.getObject=function(e){var t=this.getItem(e);return t&&JSON.parse(t)},Storage.prototype.removeObject=function(e,t){this.removeItem(e,JSON.stringify(t))};var G=E,W=n(299),Q=n(300),Y=n(104),M=n(185),q=(l.a.Header,l.a.Content),V=(l.a.Footer,n(143));Storage.prototype.setObject=function(e,t){this.setItem(e,JSON.stringify(t))},Storage.prototype.getObject=function(e){var t=this.getItem(e);return t&&JSON.parse(t)};var z=function(e){Object(g.a)(n,e);var t=Object(k.a)(n);function n(e){var s;return Object(y.a)(this,n),(s=t.call(this,e)).state={},s}return Object(x.a)(n,[{key:"createbutton",value:function(){var e=this;return function(){return Object(p.jsxs)(W.a,{name:"basic",labelCol:{span:8},wrapperCol:{span:16},initialValues:{remember:!0},onFinish:function(t){var n={password:t.password,username:t.username};V.post("/create",n).then((function(t){e.setState({createres:t.data}),"Username Already Exists"!==t.data&&(window.localStorage.setObject("user",t.data),e.props.history.push("/simulator"))})).catch((function(t){console.log(t),e.setState({createres:"denied"})}))},onFinishFailed:function(e){console.log("Failed:",e)},autoComplete:"off",children:[Object(p.jsx)(W.a.Item,{label:"Username",name:"username",rules:[{required:!0,message:"Please input your new username!"},{max:15,message:"Username must be less 15 or less characters."},{pattern:new RegExp(/^[A-Z@.a-z0-9]*$/i),message:"Username must be alphanumeric."}],children:Object(p.jsx)(Q.a,{})}),Object(p.jsx)(W.a.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please input your new password!"},{max:25,message:"Password must be 25 or fewer characters."}],children:Object(p.jsx)(Q.a.Password,{})}),Object(p.jsx)(W.a.Item,{wrapperCol:{offset:8,span:16},children:Object(p.jsx)(A.a,{type:"primary",htmlType:"submit",children:"Submit"})})]})}}},{key:"loginbutton",value:function(){var e=this;return function(){return Object(p.jsxs)(W.a,{name:"basic",labelCol:{span:8},wrapperCol:{span:16},initialValues:{remember:!0},onFinish:function(t){var n={password:t.password,username:t.username};V.post("/login",n).then((function(t){e.setState({loginres:t.data}),"denied"!==t.data&&(window.localStorage.setItem("user",JSON.stringify(t.data)),e.props.history.push("/simulator"))})).catch((function(t){console.log(t),e.setState({loginres:"denied"})})),console.log("Success:",t)},onFinishFailed:function(e){console.log("Failed:",e)},autoComplete:"off",children:[Object(p.jsx)(W.a.Item,{label:"Username",name:"username",rules:[{required:!0,message:"Please input your username!"},{max:15,message:"Username must be 15 or fewer characters."},{pattern:new RegExp(/^[A-Z@.a-z0-9]*$/i),message:"Username must be alphanumeric."}],children:Object(p.jsx)(Q.a,{})}),Object(p.jsx)(W.a.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please input your password!"}],children:Object(p.jsx)(Q.a.Password,{})}),Object(p.jsx)(W.a.Item,{name:"remember",valuePropName:"checked",wrapperCol:{offset:8,span:16},children:Object(p.jsx)(Y.a,{children:"Remember me"})}),Object(p.jsx)(W.a.Item,{wrapperCol:{offset:8,span:16},children:Object(p.jsx)(A.a,{type:"primary",htmlType:"submit",children:"Submit"})})]})}}},{key:"render",value:function(){var e,t,n=this.loginbutton(),s=this.createbutton(),i=this.navbar();return e="denied"===this.state.loginres?M.a.error({message:"Login Failed",description:"Please try your username and password again.",placement:"bottomright",duration:8}):"",t="denied"===this.state.createres?M.a.error({message:"Could not create account!",description:"Username already exists",placement:"bottomright",duration:8}):"",Object(p.jsxs)("div",{children:[i,Object(p.jsx)(l.a,{className:"layout",children:Object(p.jsxs)(q,{style:{padding:"0 50px"},children:[Object(p.jsx)(d.a,{style:{margin:"58px 0"}}),Object(p.jsx)("div",{className:"site-layout-content",children:Object(p.jsxs)("span",{children:[Object(p.jsx)("div",{className:"sectiontit",children:"Log-In:"}),Object(p.jsx)(n,{}),e,t,Object(p.jsx)("div",{className:"sectiontit",children:"Or create an account:"}),Object(p.jsx)(s,{})]})})]})})]})}},{key:"navbar",value:function(){var e,t,n=this;return this.state.user?(e="Logged in as "+this.state.user.username,t=Object(p.jsx)(A.a,{className:"username",onClick:function(){window.localStorage.removeObject("user"),n.props.history.push("/")},children:"Log Out"})):(e="",t=""),Object(p.jsx)(h.a,{fixed:"top",bg:"primary",variant:"dark",children:Object(p.jsxs)(u.a,{children:[Object(p.jsx)(h.a.Brand,{href:"/instantrunoff/",children:"Social Choice"}),Object(p.jsxs)(m.a,{className:"me-auto",children:[Object(p.jsx)(m.a.Link,{href:"/instantrunoff/",children:"About"}),Object(p.jsx)(m.a.Link,{href:"/instantrunoff/simulator",children:"Run Decision Algorithms"}),Object(p.jsx)(m.a.Link,{href:"/instantrunoff/login",children:"Log In/Create Account"}),Object(p.jsx)(m.a.Link,{href:"/instantrunoff/addelection",children:"Create my Own Scenario"}),Object(p.jsx)(h.a.Text,{children:e}),t]})]})})}}]),n}(i.a.Component),U=n(23),H=n(11),Z=n(80),$=n.n(Z),K=n(148),X=n(302),ee=n(303),te=n(304),ne=["key","name","fieldkey"],se=w.a.Option,ie=n(143),ae=function(e){Object(g.a)(n,e);var t=Object(k.a)(n);function n(e){var s;return Object(y.a)(this,n),(s=t.call(this,e)).state={election:null},s}return Object(x.a)(n,[{key:"componentDidMount",value:function(){var e=window.localStorage.getObject("user");this.setState({user:e}),e||this.props.history.push("/login")}},{key:"render",value:function(){var e=this,t={labelCol:{xs:{span:32},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}},n={wrapperCol:{xs:{span:24,offset:0},sm:{span:20,offset:4}}},i=function(){return Object(p.jsxs)(W.a,Object(H.a)(Object(H.a)({size:"large",name:"dynamic_form_item"},n),{},{onFinish:function(t){e.setState({election:t}),console.log("Received values of form:",t)},children:[Object(p.jsx)(W.a.Item,{name:"name",label:"Decision Name",children:Object(p.jsx)(Q.a,{})}),Object(p.jsx)(W.a.Item,{name:"description",label:"Decision Description",children:Object(p.jsx)(Q.a.TextArea,{style:{width:"200px"}})}),Object(p.jsx)(W.a.List,{name:"candidates",rules:[{validator:function(){var e=Object(K.a)($.a.mark((function e(t,n){var s,i;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n&&!(n.length<2)){e.next=2;break}return e.abrupt("return",Promise.reject(new Error("Add at least 2 choices")));case 2:s=0;case 3:if(!(s<n.length)){e.next=14;break}i=0;case 5:if(!(i<n.length)){e.next=11;break}if(s===i||n[s]!==n[i]){e.next=8;break}return e.abrupt("return",Promise.reject(new Error("Choices must have different names")));case 8:i++,e.next=5;break;case 11:s++,e.next=3;break;case 14:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}],children:function(e,i,a){var r=i.add,o=i.remove,c=a.errors;return Object(p.jsxs)(p.Fragment,{children:[e.map((function(i,a){return Object(s.createElement)(W.a.Item,Object(H.a)(Object(H.a)({},0===a?t:n),{},{label:0===a?"Choices:":"",required:!1,key:i.key}),Object(p.jsx)(W.a.Item,Object(H.a)(Object(H.a)({},i),{},{validateTrigger:["onChange","onBlur"],rules:[{required:!0,whitespace:!0,message:"Please input choice's name or delete this field."}],noStyle:!0,children:Object(p.jsx)(Q.a,{placeholder:"Choice name",style:{width:"60%"}})})),e.length>1?Object(p.jsx)(ee.a,{className:"dynamic-delete-button",onClick:function(){return o(i.name)}}):null)})),Object(p.jsxs)(W.a.Item,{children:[Object(p.jsx)(A.a,{type:"dashed",onClick:function(){return r()},style:{width:"60%"},icon:Object(p.jsx)(te.a,{}),children:"Add choice"}),Object(p.jsx)(W.a.ErrorList,{errors:c})]})]})}}),Object(p.jsx)(W.a.Item,{children:Object(p.jsx)(A.a,{type:"primary",htmlType:"submit",children:"Submit"})})]}))};if(null===this.state.election)return Object(p.jsxs)("div",{children:[this.navbar(),Object(p.jsx)("div",{className:"game",children:Object(p.jsxs)("span",{children:[Object(p.jsx)("div",{className:"sectiontit",children:"First name your decision and identify your options:"}),Object(p.jsx)(i,{})]})})]});var a=function(){return Object(p.jsxs)(W.a,{size:"large",name:"dynamic_form_nest_item",onFinish:function(t){var n=e.state.election.candidates.length,s=t.ballots.map((function(e,t){for(var s,i,a=[],r=1;r<=n;r++)s="preference"+String(r),console.log(s),i=e.order[s],a.push(i);return{order:a,votes:e.votes}})),i=e.state.election;i.ballots=s,i.numcands=n,i.username=e.state.user.username,i.password=e.state.user.password,ie.post("/createelect",i).then((function(t){e.setState({createret:t.data}),"createfailed"!==t.data&&(window.localStorage.setObject("user",t.data),e.props.history.push("/simulator"))})).catch((function(t){console.log(t),e.setState({election:null})})),console.log("Received values of form:",t),console.log("Received Ballots of form:",s),console.log("Received Election of form:",i)},children:[Object(p.jsx)(W.a.List,{name:"ballots",rules:[{validator:function(){var e=Object(K.a)($.a.mark((function e(t,n){var s,i,a,r;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n&&!(n.length<1)){e.next=4;break}return e.abrupt("return",Promise.reject(new Error("Add at least 1 preference set")));case 4:e.t0=$.a.keys(n);case 5:if((e.t1=e.t0()).done){e.next=20;break}if(i=e.t1.value,s=new Set,!n[i]){e.next=18;break}a=Object.values(n[i].order),e.t2=$.a.keys(a);case 11:if((e.t3=e.t2()).done){e.next=18;break}if(r=e.t3.value,!s.has(a[r])){e.next=15;break}return e.abrupt("return",Promise.reject(new Error("Each choice must be listed exactly once in each preference ordering")));case 15:s.add(a[r]),e.next=11;break;case 18:e.next=5;break;case 20:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}],children:function(t,n,s){var i=n.add,a=n.remove,r=s.errors;return Object(p.jsxs)(p.Fragment,{children:[t.map((function(t){var n=t.key,s=t.name,i=t.fieldkey,r=Object(U.a)(t,ne);return Object(p.jsxs)(X.b,{style:{display:"flex",marginbottom:8},align:"baseline",children:[e.state.election.candidates.map((function(t,n){var a,r="#"+(n+1)+" choice:",o="preference"+(n+1),c=(a=n,e.state.election.candidates.map((function(e,t){var n=String(a)+String(t);return Object(p.jsx)(se,{value:e,children:e},n)})));return[Object(p.jsx)(W.a.Item,{name:[s,"order",o],fieldkey:[i,"order",o],rules:[{required:!0,message:"Preference choice is required"}],children:Object(p.jsx)(w.a,{label:r,placeholder:r,children:c},n)})]})),Object(p.jsx)(W.a.Item,Object(H.a)(Object(H.a)({},r),{},{name:[s,"votes"],fieldkey:[i,"votes"],rules:[{required:!0,message:"Must input votes"}],children:Object(p.jsx)(Q.a,{label:"votes",style:{width:"50%"},placeholder:"Votes"})})),Object(p.jsx)(ee.a,{className:"dynamic-delete-button",onClick:function(){return a(s)}})]},n)})),Object(p.jsxs)(W.a.Item,{children:[Object(p.jsx)(A.a,{type:"dashed",onClick:function(){return i()},style:{width:"60%"},icon:Object(p.jsx)(te.a,{}),children:"Add Preference Order"}),Object(p.jsx)(W.a.ErrorList,{errors:r})]})]})}}),Object(p.jsx)(W.a.Item,{children:Object(p.jsx)(A.a,{type:"primary",htmlType:"submit",children:"Submit"})})]})};return Object(p.jsxs)("div",{children:[this.navbar(),Object(p.jsx)("div",{className:"game",children:Object(p.jsxs)("span",{children:[Object(p.jsx)("div",{className:"sectiontit",children:"Now input the preference profile for this decision:"}),Object(p.jsx)(a,{})]})})]})}},{key:"navbar",value:function(){var e,t,n=this;return this.state.user?(e="Logged in as "+this.state.user.username,t=Object(p.jsx)(A.a,{className:"username",onClick:function(){window.localStorage.removeObject("user"),n.props.history.push("/")},children:"Log Out"})):(e="",t=""),Object(p.jsx)(h.a,{fixed:"top",bg:"primary",variant:"dark",children:Object(p.jsxs)(u.a,{children:[Object(p.jsx)(h.a.Brand,{href:"/instantrunoff/",children:"Social Choice"}),Object(p.jsxs)(m.a,{className:"me-auto",children:[Object(p.jsx)(m.a.Link,{href:"/instantrunoff/",children:"About"}),Object(p.jsx)(m.a.Link,{href:"/instantrunoff/simulator",children:"Run Decision Algorithms"}),Object(p.jsx)(m.a.Link,{href:"/instantrunoff/login",children:"Log In/Create Account"}),Object(p.jsx)(m.a.Link,{href:"/instantrunoff/addelection",children:"Create my Own Scenario"}),Object(p.jsx)(h.a.Text,{children:e}),t]})]})})}}]),n}(i.a.Component);Storage.prototype.getObject=function(e){var t=this.getItem(e);return t&&JSON.parse(t)},Storage.prototype.setObject=function(e,t){this.setItem(e,JSON.stringify(t))};var re=ae;r.a.render(Object(p.jsx)(o.a,{basename:"/instantrunoff",children:Object(p.jsxs)(c.c,{children:[Object(p.jsx)(c.a,{exact:!0,path:"/",component:b}),Object(p.jsx)(c.a,{path:"/simulator",component:G}),Object(p.jsx)(c.a,{path:"/login",component:z}),Object(p.jsx)(c.a,{path:"/addelection",component:re})]})}),document.getElementById("root"))}},[[293,1,2]]]);
//# sourceMappingURL=main.7b756d51.chunk.js.map